<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Paddle Ball</title>
<style>
:root {
  --green: #0f0;
  --yellow: #ff0;
  --red: #f00;
  --bg: #000;
  --focus-outline: #0ff;
}

/* Accessibility and mobile improvements */
* {
  box-sizing: border-box;
}

body { 
  background: var(--bg); 
  color: var(--green); 
  font-family: monospace; 
  display: flex; 
  justify-content: center; 
  align-items: flex-start; 
  height: 100%; 
  margin: 0; 
  padding: 15px;
  font-size: 16px; /* Prevent zoom on mobile */
}

/* Focus styles for accessibility */
*:focus {
  outline: 2px solid var(--focus-outline);
  outline-offset: 2px;
}

/* Mobile-first responsive design */
#container { 
  min-height: 100vh;
  display: flex; 
  flex-direction: column;
  gap: 15px; 
  align-items: center;
  width: 100%;
  max-width: 1200px;
}

#gameNav, 
#gameNav a {
  display: block;
  margin-top: 5px;
  text-transform: uppercase;
  color: var(--green);
  text-decoration: none;
  padding: 8px;
  border-radius: 4px;
  transition: background-color 0.2s;
}

#gameNav a:hover,
#gameNav a:focus {
  background-color: rgba(0, 255, 0, 0.1);
}

#gameNav a.active {
  color: var(--yellow);
  font-weight: bold;
  text-decoration: underline;
  background-color: rgba(255, 255, 0, 0.1);
}

#pongGame { 
  border: 4px solid var(--green); 
  height: auto;
  width: 100%;
  max-width: 960px;
  aspect-ratio: 960/480;
  image-rendering: pixelated; 
  background: var(--bg); 
  display: block;
  border-radius: 6px;
}

#sidebar { 
  display: flex; 
  flex-direction: column; 
  gap: 15px;
  width: 100%;
  max-width: 450px;
}

#title { 
  text-transform: uppercase; 
  font-size: clamp(1.5rem, 4vw, 2rem);
  color: var(--yellow); 
  text-shadow: 0 0 8px var(--red); 
  text-align: center;
  margin: 0;
}

#scoreboard { 
  border: 2px solid var(--green); 
  padding: 12px;
  border-radius: 6px;
}

.section-title { 
  color: var(--yellow); 
  margin-bottom: 8px; 
  font-weight: bold;
}

#instructions {
  line-height: 1.4;
}

#speedInput {
  background: var(--bg);
  color: var(--green);
  border: 1px solid var(--green);
  padding: 6px;
  border-radius: 4px;
  font-family: monospace;
  margin-top: 8px;
  width: 100%;
}

#speedInput:focus {
  border-color: var(--focus-outline);
}

/* Mobile controls */
.mobile-controls {
  display: none;
  gap: 10px;
  margin-top: 15px;
  justify-content: center;
  flex-wrap: wrap;
}

/* Touch/swipe controls */
.touch-controls {
  display: none;
  position: relative;
  width: 100%;
  height: 200px;
  margin-top: 15px;
  border: 2px solid var(--green);
  border-radius: 8px;
  background: rgba(0, 255, 0, 0.1);
}

.touch-controls .left-zone {
  position: absolute;
  left: 0;
  top: 0;
  width: 50%;
  height: 100%;
  background: rgba(255, 0, 0, 0.1);
}

.touch-controls .right-zone {
  position: absolute;
  right: 0;
  top: 0;
  width: 50%;
  height: 100%;
  background: rgba(0, 0, 255, 0.1);
}

.touch-controls .zone-label {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: var(--green);
  font-weight: bold;
  font-size: 1.2rem;
  text-align: center;
}

.touch-controls .left-zone .zone-label {
  left: 25%;
}

.touch-controls .right-zone .zone-label {
  right: 25%;
  left: auto;
}

.mobile-btn {
  background: rgba(0, 255, 0, 0.2);
  border: 2px solid var(--green);
  color: var(--green);
  padding: 15px;
  border-radius: 8px;
  font-size: 1.2rem;
  font-family: monospace;
  cursor: pointer;
  user-select: none;
  touch-action: manipulation;
  min-width: 60px;
  transition: all 0.2s;
}

.mobile-btn:hover,
.mobile-btn:focus,
.mobile-btn:active {
  background: rgba(0, 255, 0, 0.3);
  transform: scale(1.05);
}

/* Responsive breakpoints */
@media (min-width: 768px) {
  #container {
    flex-direction: row;
    align-items: flex-start;
    gap: 20px;
    padding: 20px;
  }
  
  #pongGame {
    height: 80vh;
    width: 100vw;
    max-width: 960px;
  }
  
  #sidebar {
    width: 450px;
  }
  
  .mobile-controls {
    display: none;
  }
}

@media (max-width: 767px) {
  .mobile-controls {
    display: flex;
  }
  
  .touch-controls {
    display: block;
  }
  
  body {
    padding: 10px;
  }
  
  #pongGame {
    max-width: 100vw;
    margin: 0 auto;
  }
  
  #title {
    margin-top: 10px;
    margin-bottom: 10px;
  }
  
  #sidebar {
    order: 3;
  }
  
  #pongGame {
    order: 2;
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  :root {
    --green: #00ff00;
    --yellow: #ffff00;
    --red: #ff0000;
    --focus-outline: #ffffff;
  }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Skip link for accessibility */
.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: var(--green);
  color: var(--bg);
  padding: 8px;
  text-decoration: none;
  border-radius: 4px;
  z-index: 1001;
  transition: top 0.3s;
}

.skip-link:focus {
  top: 6px;
}

/* Screen reader support */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}
</style>
</head>
<body>
<!-- Skip to main content link for accessibility -->
<a href="#pongGame" class="skip-link">Skip to game</a>

<div id="container">
    <nav id="gameNav" style="padding:10px; background:#111; color:#0f0; font-family:monospace;">
    <strong>Games:</strong>
  </nav>
  <h1 id="title">Paddle Ball</h1>
  <canvas id="pongGame" width="960" height="480" role="img" aria-label="Paddle Ball game area" tabindex="0"></canvas>
  <div id="sidebar">
    <div id="scoreboard" role="region" aria-label="Game Score">
      <div class="section-title">SCORE</div>
      <div id="score" aria-live="polite">0 - 0</div>
    </div>
    <div id="instructions" role="region" aria-label="Game Controls">
      <div class="section-title">CONTROLS</div>
      <div role="list">
        <div role="listitem">W / S: Move Left Paddle Up/Down</div>
        <div role="listitem">‚Üë / ‚Üì: Move Right Paddle Up/Down</div>
        <div role="listitem">P: Pause</div>
        <div role="listitem">R: Reset</div>
      </div>
      <label for="speedInput">Initial Speed (ms per frame):</label>
      <input type="number" id="speedInput" value="70" min="5" max="100" aria-describedby="speedHelp" />
      <div id="speedHelp" class="sr-only">Adjust game speed from 5 to 100 milliseconds per frame</div>
    </div>
    
    <!-- Mobile Controls -->
    <div class="mobile-controls">
      <button class="mobile-btn" id="leftUpBtn" aria-label="Move Left Paddle Up">W</button>
      <button class="mobile-btn" id="leftDownBtn" aria-label="Move Left Paddle Down">S</button>
      <button class="mobile-btn" id="rightUpBtn" aria-label="Move Right Paddle Up">‚Üë</button>
      <button class="mobile-btn" id="rightDownBtn" aria-label="Move Right Paddle Down">‚Üì</button>
      <button class="mobile-btn" id="pauseBtn" aria-label="Pause/Resume">‚è∏</button>
      <button class="mobile-btn" id="resetBtn" aria-label="Reset Game">üîÑ</button>
    </div>
    
    <!-- Touch/Swipe Controls -->
    <div class="touch-controls">
      <div class="left-zone">
        <div class="zone-label">Left Paddle<br>Touch & Swipe</div>
      </div>
      <div class="right-zone">
        <div class="zone-label">Right Paddle<br>Touch & Swipe</div>
      </div>
    </div>
  </div>
</div>
<script src="navigation.js"></script>
<script>
const canvas = document.getElementById('pongGame');
const context = canvas.getContext('2d');
const scale = 20;
const rows = canvas.height / scale;
const cols = canvas.width / scale;
let paused = false;
let speed = parseInt(document.getElementById('speedInput').value);
let paddleSpeed = 3; // Increased paddle movement per key press

let paddleHeight = 4;
let leftPaddle = {y: rows/2 - paddleHeight/2};
let rightPaddle = {y: rows/2 - paddleHeight/2};
let ball = {x: cols/2, y: rows/2, dx: 1, dy: 1};
let score = [0,0];
let lastTime = 0;

function draw() {
    context.fillStyle = '#000';
    context.fillRect(0,0,canvas.width,canvas.height);
    context.save();
    context.scale(scale, scale);

    // paddles
    context.fillStyle = '#0f0';
    for(let i=0;i<paddleHeight;i++){
        context.fillRect(0, leftPaddle.y + i, 1, 1);
        context.fillRect(cols-1, rightPaddle.y + i, 1, 1);
    }

    // ball
    context.fillRect(ball.x, ball.y, 1, 1);

    context.restore();
    document.getElementById('score').textContent = score[0] + ' - ' + score[1];
}

function update(time = 0) {
    if(paused) {
        requestAnimationFrame(update);
        return;
    }
    if(time - lastTime < speed) {
        requestAnimationFrame(update);
        return;
    }
    lastTime = time;

    ball.x += ball.dx;
    ball.y += ball.dy;

    if(ball.y < 0 || ball.y >= rows) ball.dy *= -1;
    if(ball.x === 1 && ball.y >= leftPaddle.y && ball.y < leftPaddle.y + paddleHeight) ball.dx *= -1;
    if(ball.x === cols-2 && ball.y >= rightPaddle.y && ball.y < rightPaddle.y + paddleHeight) ball.dx *= -1;

    if(ball.x < 0){ score[1]++; resetBall(); }
    if(ball.x >= cols){ score[0]++; resetBall(); }

    draw();
    requestAnimationFrame(update);
}

function resetBall() {
    ball.x = cols/2;
    ball.y = rows/2;
    ball.dx = Math.random() > 0.5 ? 1 : -1;
    ball.dy = Math.random() > 0.5 ? 1 : -1;
}

document.getElementById('speedInput').addEventListener('change', e => {
    speed = parseInt(e.target.value);
});

/* ===== Mobile Controls ===== */
const leftUpBtn = document.getElementById('leftUpBtn');
const leftDownBtn = document.getElementById('leftDownBtn');
const rightUpBtn = document.getElementById('rightUpBtn');
const rightDownBtn = document.getElementById('rightDownBtn');
const pauseBtn = document.getElementById('pauseBtn');
const resetBtn = document.getElementById('resetBtn');

// Mobile button handlers
leftUpBtn.addEventListener('click', () => {
  if(leftPaddle.y > 0) leftPaddle.y = Math.max(0, leftPaddle.y - paddleSpeed);
});

leftDownBtn.addEventListener('click', () => {
  if(leftPaddle.y + paddleHeight < rows) leftPaddle.y = Math.min(rows - paddleHeight, leftPaddle.y + paddleSpeed);
});

rightUpBtn.addEventListener('click', () => {
  if(rightPaddle.y > 0) rightPaddle.y = Math.max(0, rightPaddle.y - paddleSpeed);
});

rightDownBtn.addEventListener('click', () => {
  if(rightPaddle.y + paddleHeight < rows) rightPaddle.y = Math.min(rows - paddleHeight, rightPaddle.y + paddleSpeed);
});

pauseBtn.addEventListener('click', () => {
  paused = !paused;
  pauseBtn.textContent = paused ? '‚ñ∂' : '‚è∏';
});

resetBtn.addEventListener('click', () => {
  score = [0, 0];
  resetBall();
});

// Touch support for mobile
let touchStartY = 0;
let touchStartX = 0;

canvas.addEventListener('touchstart', (e) => {
  e.preventDefault();
  const touch = e.touches[0];
  touchStartY = touch.clientY;
  touchStartX = touch.clientX;
}, { passive: false });

canvas.addEventListener('touchend', (e) => {
  e.preventDefault();
  const touch = e.changedTouches[0];
  const deltaY = touch.clientY - touchStartY;
  const deltaX = touch.clientX - touchStartX;
  
  // Determine which side of the screen was touched
  const isLeftSide = touchStartX < canvas.width / 2;
  
  if (Math.abs(deltaY) > 30) {
    if (isLeftSide) {
      // Left paddle
      if (deltaY > 0) {
        if(leftPaddle.y + paddleHeight < rows) leftPaddle.y = Math.min(rows - paddleHeight, leftPaddle.y + paddleSpeed);
      } else {
        if(leftPaddle.y > 0) leftPaddle.y = Math.max(0, leftPaddle.y - paddleSpeed);
      }
    } else {
      // Right paddle
      if (deltaY > 0) {
        if(rightPaddle.y + paddleHeight < rows) rightPaddle.y = Math.min(rows - paddleHeight, rightPaddle.y + paddleSpeed);
      } else {
        if(rightPaddle.y > 0) rightPaddle.y = Math.max(0, rightPaddle.y - paddleSpeed);
      }
    }
  }
}, { passive: false });

document.addEventListener('keydown', e => {
    switch(e.code){
        case 'KeyW': if(leftPaddle.y>0) leftPaddle.y = Math.max(0, leftPaddle.y - paddleSpeed); break;
        case 'KeyS': if(leftPaddle.y+paddleHeight<rows) leftPaddle.y = Math.min(rows - paddleHeight, leftPaddle.y + paddleSpeed); break;
        case 'ArrowUp': if(rightPaddle.y>0) rightPaddle.y = Math.max(0, rightPaddle.y - paddleSpeed); break;
        case 'ArrowDown': if(rightPaddle.y+paddleHeight<rows) rightPaddle.y = Math.min(rows - paddleHeight, rightPaddle.y + paddleSpeed); break;
        case 'KeyP': paused = !paused; break;
        case 'KeyR': score=[0,0]; resetBall(); break;
    }
});

resetBall();
update();
</script>
</body>
</html>
